
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the STUD'IN platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "role": {
          "type": "string",
          "description": "The role of the user.",
          "enum": ["student", "institution", "admin"]
        },
        "username": {
            "type": "string",
            "description": "User's public username."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "firstName": {
          "type": "string",
          "description": "User's first name."
        },
        "lastName": {
          "type": "string",
          "description": "User's last name."
        },
        "phone": {
          "type": "string",
          "description": "User's phone number."
        },
        "university": {
          "type": "string",
          "description": "University the user attends."
        },
        "postalCode": {
          "type": "string",
          "description": "Postal code of the user's city."
        },
        "city": {
          "type": "string",
          "description": "City where the user lives."
        },
        "fieldOfStudy": {
          "type": "string",
          "description": "User's field of study."
        },
        "bio": {
          "type": "string",
          "description": "User's biography or description."
        },
        "website": {
            "type": "string",
            "description": "User's personal website or link.",
            "format": "uri"
        },
        "gender": {
            "type": "string",
            "description": "User's gender.",
            "enum": ["male", "female", "non-binary", "prefer-not-to-say"]
        },
        "profilePicture": {
          "type": "string",
          "description": "URL of the user's profile picture.",
          "format": "uri"
        },
        "isVerified": {
            "type": "boolean",
            "description": "Indicates if the user has a verified badge."
        },
        "points": {
            "type": "number",
            "description": "Total points earned from challenges."
        },
        "challengesCompleted": {
            "type": "number",
            "description": "Number of challenges successfully completed."
        },
        "followerIds": {
          "type": "array",
          "description": "List of user IDs who are following this user.",
          "items": {
            "type": "string"
          }
        },
        "followingIds": {
          "type": "array",
          "description": "List of user IDs this user is following.",
          "items": {
            "type": "string"
          }
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the user was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the user was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "role",
        "username",
        "email"
      ]
    },
    "Institution": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Institution",
        "type": "object",
        "description": "Represents an institutional partner on the STUD'IN platform.",
        "properties": {
            "id": { "type": "string" },
            "role": { "type": "string", "enum": ["institution"]},
            "userId": { "type": "string", "description": "The ID of the user account associated with this institution." },
            "name": { "type": "string" },
            "postalCode": { "type": "string" },
            "city": { "type": "string" },
            "email": { "type": "string", "format": "email" },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["id", "userId", "name", "postalCode", "city", "email", "role"]
    },
     "Post": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Post",
      "type": "object",
      "description": "Represents a social media post on the STUD'IN platform.",
      "properties": {
        "id": { "type": "string" },
        "caption": { "type": "string" },
        "imageUrl": { "type": "string", "format": "uri" },
        "location": { "type": "string" },
        "userId": { "type": "string" },
        "username": { "type": "string" },
        "userAvatarUrl": { "type": "string", "format": "uri" },
        "createdAt": { "type": "string", "format": "date-time" },
        "likes": { "type": "array", "items": { "type": "string" } },
        "comments": { "type": "array", "items": { "type": "object" } }
      },
      "required": ["id", "caption", "userId", "username", "createdAt"]
    },
    "Book": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Book",
        "type": "object",
        "description": "Represents a book listing in the book exchange.",
        "properties": {
            "id": { "type": "string" },
            "title": { "type": "string" },
            "author": { "type": "string" },
            "description": { "type": "string" },
            "condition": { "type": "string", "enum": ["Neuf", "Très bon", "Bon", "Acceptable"] },
            "price": { "type": "number" },
            "imageUrl": { "type": "string", "format": "uri" },
            "sellerId": { "type": "string" },
            "sellerName": { "type": "string" },
            "sellerAvatarUrl": { "type": "string", "format": "uri" },
            "course": { "type": "string" },
            "university": { "type": "string" },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["id", "title", "author", "condition", "price", "sellerId"]
    },
    "Housing": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Housing",
      "type": "object",
      "description": "Represents a housing listing on the STUD'IN platform.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string" },
        "username": { "type": "string" },
        "userAvatarUrl": { "type": "string", "format": "uri" },
        "title": { "type": "string" },
        "description": { "type": "string" },
        "type": { "type": "string", "enum": ["kot", "studio", "colocation"] },
        "price": { "type": "number" },
        "address": { "type": "string" },
        "city": { "type": "string" },
        "bedrooms": { "type": "number" },
        "surface_area": { "type": "number" },
        "imageUrl": { "type": "string", "format": "uri" },
        "imageHint": { "type": "string" },
        "coordinates": { "type": "array", "items": { "type": "number" } },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "userId", "username", "title", "type", "price", "address", "city" ]
    },
    "Reel": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Reel",
      "type": "object",
      "description": "Represents a short video reel on the STUD'IN platform.",
      "properties": {
        "id": { "type": "string" },
        "videoUrl": { "type": "string", "format": "uri" },
        "caption": { "type": "string" },
        "userId": { "type": "string" },
        "username": { "type": "string" },
        "userAvatarUrl": { "type": "string", "format": "uri" },
        "createdAt": { "type": "string", "format": "date-time" },
        "likes": { "type": "array", "items": { "type": "string" } },
        "comments": { "type": "array", "items": { "type": "object" } }
      },
      "required": ["id", "videoUrl", "userId", "caption", "createdAt"]
    },
    "Carpooling": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Carpooling",
      "type": "object",
      "description": "Represents a carpooling offer on the STUD'IN platform.",
      "properties": {
        "id": { "type": "string" },
        "driverId": { "type": "string" },
        "username": { "type": "string" },
        "userAvatarUrl": { "type": "string", "format": "uri" },
        "departureCity": { "type": "string" },
        "arrivalCity": { "type": "string" },
        "departureTime": { "type": "string", "format": "date-time" },
        "seatsAvailable": { "type": "number" },
        "pricePerSeat": { "type": "number" },
        "passengerIds": { "type": "array", "items": { "type": "string" } },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "driverId", "username", "departureCity", "arrivalCity", "departureTime", "seatsAvailable", "pricePerSeat" ]
    },
    "CarpoolBooking": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CarpoolBooking",
      "type": "object",
      "description": "Represents a booking for a carpooling offer.",
      "properties": {
        "id": { "type": "string" },
        "carpoolId": { "type": "string" },
        "passengerId": { "type": "string" },
        "seatsBooked": { "type": "number" },
        "status": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "carpoolId", "passengerId" ]
    },
    "Tutoring": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tutoring",
      "type": "object",
      "description": "Represents a tutoring offer on the STUD'IN platform.",
      "properties": {
        "id": { "type": "string" },
        "tutorId": { "type": "string" },
        "username": { "type": "string" },
        "userAvatarUrl": { "type": "string", "format": "uri" },
        "subject": { "type": "string" },
        "level": { "type": "string" },
        "description": { "type": "string" },
        "pricePerHour": { "type": "number" },
        "locationType": { "type": "string", "enum": ["online", "in-person", "both"] },
        "rating": { "type": "number" },
        "totalReviews": { "type": "number" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "tutorId", "username", "subject", "level", "pricePerHour" ]
    },
    "TutoringReview": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TutoringReview",
      "type": "object",
      "description": "Represents a review for a tutoring offer.",
      "properties": {
        "id": { "type": "string" },
        "tutoringId": { "type": "string" },
        "studentId": { "type": "string" },
        "studentName": { "type": "string" },
        "studentAvatar": { "type": "string", "format": "uri" },
        "rating": { "type": "number" },
        "comment": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "tutoringId", "studentId", "rating" ]
    },
    "Event": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Event",
      "type": "object",
      "description": "Represents an event on the STUD'IN platform.",
      "properties": {
        "id": { "type": "string" },
        "organizerId": { "type": "string" },
        "username": { "type": "string" },
        "userAvatarUrl": { "type": "string", "format": "uri" },
        "title": { "type": "string" },
        "description": { "type": "string" },
        "category": { "type": "string", "enum": ["soirée", "conférence", "sport", "culture"] },
        "startDate": { "type": "string", "format": "date-time" },
        "city": { "type": "string" },
        "address": { "type": "string" },
        "price": { "type": "number" },
        "imageUrl": { "type": "string", "format": "uri" },
        "attendeeIds": { "type": "array", "items": { "type": "string" } },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "organizerId", "username", "title", "startDate" ]
    },
    "EventAttendee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "EventAttendee",
      "type": "object",
      "description": "Represents a user attending an event.",
      "properties": {
        "id": { "type": "string" },
        "eventId": { "type": "string" },
        "userId": { "type": "string" },
        "status": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "eventId", "userId" ]
    },
    "Favorite": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Favorite",
      "type": "object",
      "description": "Represents a user's favorite item.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string" },
        "itemType": { "type": "string", "enum": ["post", "housing", "event", "tutor"] },
        "itemId": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "userId", "itemType", "itemId" ]
    },
    "Conversation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Conversation",
      "type": "object",
      "description": "Represents a chat conversation between users.",
      "properties": {
        "participantIds": { "type": "array", "items": { "type": "string" } },
        "participants": { "type": "object" },
        "lastMessage": { "type": "object" },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" }
      },
      "required": [ "participantIds" ]
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a single message within a conversation.",
      "properties": {
        "text": { "type": "string" },
        "senderId": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" },
        "imageUrl": { "type": "string", "format": "uri" },
        "videoUrl": { "type": "string", "format": "uri" },
        "audioUrl": { "type": "string", "format": "uri" },
        "fileType": { "type": "string", "enum": ["image", "video", "audio"] }
      },
      "required": [ "senderId", "createdAt" ]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "Represents a notification for a user.",
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "enum": ["new_follower", "like", "comment", "new_message", "carpool_booking", "event_attendance"] },
        "senderId": { "type": "string" },
        "senderProfile": { "type": "object" },
        "recipientId": { "type": "string" },
        "relatedId": { "type": "string" },
        "message": { "type": "string" },
        "read": { "type": "boolean" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "type", "senderId", "recipientId", "createdAt"]
    },
    "Challenge": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Challenge",
      "type": "object",
      "description": "Represents a gamified challenge in UrbanQuest.",
      "properties": {
        "id": { "type": "string" },
        "creatorId": { "type": "string", "description": "The ID of the admin or institution who created the challenge." },
        "title": { "type": "string" },
        "description": { "type": "string" },
        "category": { "type": "string", "enum": ["Exploration", "Social", "Créatif", "Académique"] },
        "difficulty": { "type": "string", "enum": ["facile", "moyen", "difficile"] },
        "points": { "type": "number" },
        "imageUrl": { "type": "string", "format": "uri" },
        "location": { "type": "string" },
        "latitude": { "type": "number" },
        "longitude": { "type": "number" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "creatorId", "title", "category", "difficulty", "points"]
    },
    "ChallengeSubmission": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChallengeSubmission",
      "type": "object",
      "description": "Represents a user's submission for a challenge.",
      "properties": {
        "id": { "type": "string" },
        "challengeId": { "type": "string" },
        "userId": { "type": "string" },
        "userProfile": { 
            "type": "object",
            "properties": {
                "username": { "type": "string" },
                "avatarUrl": { "type": "string", "format": "uri" }
            }
        },
        "proofUrl": { "type": "string", "format": "uri" },
        "status": { "type": "string", "enum": ["pending", "approved", "rejected"] },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "challengeId", "userId", "proofUrl", "status", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/User" },
      "description": "Stores user profiles. Accessible only to the user with the matching userId."
    },
     "/institutions/{institutionId}": {
      "schema": { "$ref": "#/entities/Institution" },
      "description": "Stores institutional partner profiles."
    },
    "/users/{userId}/notifications/{notificationId}": {
      "schema": { "$ref": "#/entities/Notification" },
      "description": "Stores notifications for a specific user. Only the recipient can read them."
    },
    "/users/{userId}/favorites/{favoriteId}": {
      "schema": { "$ref": "#/entities/Favorite" },
      "description": "Stores user favorites. Includes userId for ownership validation."
    },
    "/posts/{postId}": {
      "schema": { "$ref": "#/entities/Post" },
      "description": "Stores social media posts. Publicly readable."
    },
    "/books/{bookId}": {
      "schema": { "$ref": "#/entities/Book" },
      "description": "Stores book listings for the book exchange."
    },
    "/reels/{reelId}": {
      "schema": { "$ref": "#/entities/Reel" },
      "description": "Stores short video reels. Publicly readable."
    },
    "/housings/{housingId}": {
      "schema": { "$ref": "#/entities/Housing" },
      "description": "Stores housing listings. Includes userId for ownership validation."
    },
    "/carpoolings/{carpoolingId}": {
      "schema": { "$ref": "#/entities/Carpooling" },
      "description": "Stores carpooling offers. Includes driverId for ownership validation."
    },
    "/carpoolings/{carpoolingId}/carpool_bookings/{carpoolBookingId}": {
      "schema": { "$ref": "#/entities/CarpoolBooking" },
      "description": "Stores bookings for carpooling. Includes passengerId and the carpooling's driverId."
    },
    "/tutorings/{tutoringId}": {
      "schema": { "$ref": "#/entities/Tutoring" },
      "description": "Stores tutoring offers. Includes tutorId for ownership validation."
    },
    "/tutoring_reviews/{tutoringReviewId}": {
      "schema": { "$ref": "#/entities/TutoringReview" },
      "description": "Stores reviews for tutoring. Includes studentId and the tutoring's tutorId."
    },
    "/events/{eventId}": {
      "schema": { "$ref": "#/entities/Event" },
      "description": "Stores events. Includes organizerId for ownership validation."
    },
    "/event_attendees/{eventAttendeeId}": {
      "schema": { "$ref": "#/entities/EventAttendee" },
      "description": "Stores records of users attending events. Includes userId for attendance validation."
    },
    "/conversations/{conversationId}": {
      "schema": { "$ref": "#/entities/Conversation" },
      "description": "Stores metadata for a chat conversation between users."
    },
    "/conversations/{conversationId}/messages/{messageId}": {
      "schema": { "$ref": "#/entities/ChatMessage" },
      "description": "Stores the individual messages for a specific conversation."
    },
    "/challenges/{challengeId}": {
      "schema": { "$ref": "#/entities/Challenge" },
      "description": "Stores UrbanQuest challenges. Publicly readable."
    },
    "/challenges/{challengeId}/submissions/{submissionId}": {
        "schema": { "$ref": "#/entities/ChallengeSubmission" },
        "description": "Stores user submissions for a specific challenge."
    }
  }
}
