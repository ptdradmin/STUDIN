{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Stud'in platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "firstName": {
          "type": "string",
          "description": "User's first name."
        },
        "lastName": {
          "type": "string",
          "description": "User's last name."
        },
        "phone": {
          "type": "string",
          "description": "User's phone number."
        },
        "university": {
          "type": "string",
          "description": "University the user attends."
        },
        "fieldOfStudy": {
          "type": "string",
          "description": "User's field of study."
        },
        "bio": {
          "type": "string",
          "description": "User's biography or description."
        },
        "profilePicture": {
          "type": "string",
          "description": "URL of the user's profile picture."
        },
        "isVerified": {
          "type": "boolean",
          "description": "Indicates if the user's account is verified."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the user was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the user was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "firstName",
        "lastName"
      ]
    },
    "Housing": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Housing",
      "type": "object",
      "description": "Represents a housing listing on the Stud'in platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the housing listing."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Housing)"
        },
        "title": {
          "type": "string",
          "description": "Title of the housing listing."
        },
        "description": {
          "type": "string",
          "description": "Description of the housing."
        },
        "type": {
          "type": "string",
          "description": "Type of housing (e.g., kot, studio, colocation)."
        },
        "price": {
          "type": "number",
          "description": "Price of the housing per month."
        },
        "address": {
          "type": "string",
          "description": "Address of the housing."
        },
        "city": {
          "type": "string",
          "description": "City where the housing is located."
        },
        "postalCode": {
          "type": "string",
          "description": "Postal code of the housing."
        },
        "latitude": {
          "type": "number",
          "description": "Latitude coordinate of the housing."
        },
        "longitude": {
          "type": "number",
          "description": "Longitude coordinate of the housing."
        },
        "bedrooms": {
          "type": "number",
          "description": "Number of bedrooms in the housing."
        },
        "bathrooms": {
          "type": "number",
          "description": "Number of bathrooms in the housing."
        },
        "surfaceArea": {
          "type": "number",
          "description": "Surface area of the housing in square meters."
        },
        "availableFrom": {
          "type": "string",
          "description": "Date when the housing is available from.",
          "format": "date-time"
        },
        "photos": {
          "type": "array",
          "description": "Array of URLs for photos of the housing.",
          "items": {
            "type": "string"
          }
        },
        "amenities": {
          "type": "array",
          "description": "Array of amenities available in the housing (e.g., wifi, parking, furnished).",
          "items": {
            "type": "string"
          }
        },
        "universityNearby": {
          "type": "string",
          "description": "Name of the university nearby."
        },
        "distanceToCampus": {
          "type": "number",
          "description": "Distance to campus in meters."
        },
        "isAvailable": {
          "type": "boolean",
          "description": "Indicates if the housing is currently available."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the housing listing was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the housing listing was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "type",
        "price",
        "address",
        "city"
      ]
    },
    "Carpooling": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Carpooling",
      "type": "object",
      "description": "Represents a carpooling opportunity on the Stud'in platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the carpooling opportunity."
        },
        "driverId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Carpooling)"
        },
        "departureCity": {
          "type": "string",
          "description": "City of departure."
        },
        "departureAddress": {
          "type": "string",
          "description": "Address of departure."
        },
        "arrivalCity": {
          "type": "string",
          "description": "City of arrival."
        },
        "arrivalAddress": {
          "type": "string",
          "description": "Address of arrival."
        },
        "departureTime": {
          "type": "string",
          "description": "Date and time of departure.",
          "format": "date-time"
        },
        "seatsAvailable": {
          "type": "number",
          "description": "Number of seats available."
        },
        "pricePerSeat": {
          "type": "number",
          "description": "Price per seat."
        },
        "description": {
          "type": "string",
          "description": "Description of the carpooling opportunity."
        },
        "carModel": {
          "type": "string",
          "description": "Car model being used for carpooling."
        },
        "preferences": {
          "type": "array",
          "description": "Array of preferences for the carpooling (e.g., non-smoking, music, animals).",
          "items": {
            "type": "string"
          }
        },
        "isRecurring": {
          "type": "boolean",
          "description": "Indicates if the carpooling is a recurring event."
        },
        "recurringDays": {
          "type": "array",
          "description": "Array of days the carpooling recurs on (e.g., monday, wednesday).",
          "items": {
            "type": "string"
          }
        },
        "status": {
          "type": "string",
          "description": "Status of the carpooling (e.g., active, full, completed, cancelled)."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the carpooling opportunity was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "driverId",
        "departureCity",
        "arrivalCity",
        "departureTime",
        "seatsAvailable"
      ]
    },
    "CarpoolBooking": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CarpoolBooking",
      "type": "object",
      "description": "Represents a booking for a carpooling opportunity.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the carpool booking."
        },
        "carpoolId": {
          "type": "string",
          "description": "Reference to Carpooling. (Relationship: Carpooling 1:N CarpoolBooking)"
        },
        "passengerId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N CarpoolBooking)"
        },
        "seatsBooked": {
          "type": "number",
          "description": "Number of seats booked."
        },
        "status": {
          "type": "string",
          "description": "Status of the booking (e.g., pending, confirmed, cancelled)."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the booking was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "carpoolId",
        "passengerId"
      ]
    },
    "Tutoring": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tutoring",
      "type": "object",
      "description": "Represents a tutoring service offered on the Stud'in platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the tutoring service."
        },
        "tutorId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Tutoring)"
        },
        "subject": {
          "type": "string",
          "description": "Subject being tutored."
        },
        "level": {
          "type": "string",
          "description": "Level of tutoring (e.g., bachelier, master, secondaire)."
        },
        "description": {
          "type": "string",
          "description": "Description of the tutoring service."
        },
        "pricePerHour": {
          "type": "number",
          "description": "Price per hour for the tutoring service."
        },
        "locationType": {
          "type": "string",
          "description": "Type of location for tutoring (e.g., online, in-person, both)."
        },
        "availableLocations": {
          "type": "array",
          "description": "Array of available locations for tutoring (cities or campuses).",
          "items": {
            "type": "string"
          }
        },
        "availability": {
          "type": "string",
          "description": "Availability schedule for the tutor (JSON format)."
        },
        "rating": {
          "type": "number",
          "description": "Average rating of the tutor."
        },
        "totalReviews": {
          "type": "number",
          "description": "Total number of reviews for the tutor."
        },
        "qualifications": {
          "type": "array",
          "description": "Array of tutor's qualifications.",
          "items": {
            "type": "string"
          }
        },
        "isAvailable": {
          "type": "boolean",
          "description": "Indicates if the tutoring service is currently available."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the tutoring service was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "tutorId",
        "subject",
        "level"
      ]
    },
    "TutoringReview": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TutoringReview",
      "type": "object",
      "description": "Represents a review for a tutoring service.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the tutoring review."
        },
        "tutoringId": {
          "type": "string",
          "description": "Reference to Tutoring. (Relationship: Tutoring 1:N TutoringReview)"
        },
        "studentId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N TutoringReview)"
        },
        "rating": {
          "type": "number",
          "description": "Rating given by the student (1-5)."
        },
        "comment": {
          "type": "string",
          "description": "Comment provided by the student."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the review was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "tutoringId",
        "studentId",
        "rating"
      ]
    },
    "Event": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Event",
      "type": "object",
      "description": "Represents an event listed on the Stud'in platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the event."
        },
        "organizerId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Event)"
        },
        "title": {
          "type": "string",
          "description": "Title of the event."
        },
        "description": {
          "type": "string",
          "description": "Description of the event."
        },
        "category": {
          "type": "string",
          "description": "Category of the event (e.g., soirée, conférence, sport, culture)."
        },
        "startDate": {
          "type": "string",
          "description": "Date and time when the event starts.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "Date and time when the event ends.",
          "format": "date-time"
        },
        "locationName": {
          "type": "string",
          "description": "Name of the event location."
        },
        "address": {
          "type": "string",
          "description": "Address of the event location."
        },
        "city": {
          "type": "string",
          "description": "City where the event is located."
        },
        "latitude": {
          "type": "number",
          "description": "Latitude coordinate of the event location."
        },
        "longitude": {
          "type": "number",
          "description": "Longitude coordinate of the event location."
        },
        "price": {
          "type": "number",
          "description": "Price of attending the event."
        },
        "maxAttendees": {
          "type": "number",
          "description": "Maximum number of attendees allowed."
        },
        "currentAttendees": {
          "type": "number",
          "description": "Current number of attendees."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the event image."
        },
        "university": {
          "type": "string",
          "description": "University associated with the event."
        },
        "tags": {
          "type": "array",
          "description": "Array of tags for the event (e.g., gratuit, étudiant, musique).",
          "items": {
            "type": "string"
          }
        },
        "isPublic": {
          "type": "boolean",
          "description": "Indicates if the event is public."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the event was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "organizerId",
        "title",
        "startDate"
      ]
    },
    "EventAttendee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "EventAttendee",
      "type": "object",
      "description": "Represents a user attending an event.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the event attendee record."
        },
        "eventId": {
          "type": "string",
          "description": "Reference to Event. (Relationship: Event 1:N EventAttendee)"
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N EventAttendee)"
        },
        "status": {
          "type": "string",
          "description": "Status of the user's attendance (e.g., attending, maybe, not_attending)."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the attendee record was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "eventId",
        "userId"
      ]
    },
    "Message": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Message",
      "type": "object",
      "description": "Represents a message sent between users on the Stud'in platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the message."
        },
        "senderId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Message (sender))"
        },
        "receiverId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Message (receiver))"
        },
        "content": {
          "type": "string",
          "description": "Content of the message."
        },
        "isRead": {
          "type": "boolean",
          "description": "Indicates if the message has been read."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the message was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "senderId",
        "receiverId",
        "content"
      ]
    },
    "Favorite": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Favorite",
      "type": "object",
      "description": "Represents a user's favorite item (housing, tutoring, event).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the favorite record."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Favorite)"
        },
        "itemType": {
          "type": "string",
          "description": "Type of the favorited item (e.g., housing, tutoring, event)."
        },
        "itemId": {
          "type": "string",
          "description": "ID of the favorited item."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the favorite record was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "itemType",
        "itemId"
      ]
    },
    "OAuthProvider": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "OAuthProvider",
      "type": "object",
      "description": "Represents an external OAuth authentication provider linked to a user account.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the OAuth provider link."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N OAuthProvider)"
        },
        "provider": {
          "type": "string",
          "description": "Name of the OAuth provider (e.g., 'google', 'facebook')."
        },
        "providerId": {
          "type": "string",
          "description": "Unique identifier for the user within the OAuth provider."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the OAuth provider link was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "provider",
        "providerId"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Only the user can read/write their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/housings/{housingId}",
        "definition": {
          "entityName": "Housing",
          "schema": {
            "$ref": "#/backend/entities/Housing"
          },
          "description": "Stores housing listings created by the user. Only the user can manage their own listings.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "housingId",
              "description": "The unique identifier for the housing listing."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/carpoolings/{carpoolingId}",
        "definition": {
          "entityName": "Carpooling",
          "schema": {
            "$ref": "#/backend/entities/Carpooling"
          },
          "description": "Stores carpooling opportunities created by the user. Only the user can manage their own carpooling listings.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "carpoolingId",
              "description": "The unique identifier for the carpooling listing."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/carpoolBookings/{carpoolBookingId}",
        "definition": {
          "entityName": "CarpoolBooking",
          "schema": {
            "$ref": "#/backend/entities/CarpoolBooking"
          },
          "description": "Stores carpool bookings created by the user. Only the user can manage their own carpool bookings.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "carpoolBookingId",
              "description": "The unique identifier for the carpool booking."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/tutorings/{tutoringId}",
        "definition": {
          "entityName": "Tutoring",
          "schema": {
            "$ref": "#/backend/entities/Tutoring"
          },
          "description": "Stores tutoring services offered by the user. Only the user can manage their own tutoring services.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "tutoringId",
              "description": "The unique identifier for the tutoring service."
            }
          ]
        }
      },
      {
        "path": "/tutoringsReviews/{tutoringReviewId}",
        "definition": {
          "entityName": "TutoringReview",
          "schema": {
            "$ref": "#/backend/entities/TutoringReview"
          },
          "description": "Stores reviews for tutoring services. Any authenticated user can write a review for a tutoring service.",
          "params": [
            {
              "name": "tutoringReviewId",
              "description": "The unique identifier for the tutoring review."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/events/{eventId}",
        "definition": {
          "entityName": "Event",
          "schema": {
            "$ref": "#/backend/entities/Event"
          },
          "description": "Stores events created by the user. Only the user can manage their own events.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "eventId",
              "description": "The unique identifier for the event."
            }
          ]
        }
      },
      {
        "path": "/eventsAttendees/{eventAttendeeId}",
        "definition": {
          "entityName": "EventAttendee",
          "schema": {
            "$ref": "#/backend/entities/EventAttendee"
          },
          "description": "Stores events attended by a given user. ",
          "params": [
            {
              "name": "eventAttendeeId",
              "description": "The unique identifier for the event attendee."
            }
          ]
        }
      },
      {
        "path": "/messages/{messageId}",
        "definition": {
          "entityName": "Message",
          "schema": {
            "$ref": "#/backend/entities/Message"
          },
          "description": "Stores messages between users. Any authenticated user can read his messages.",
          "params": [
            {
              "name": "messageId",
              "description": "The unique identifier for the message."
            }
          ]
        }
      },
      {
        "path": "/favorites/{favoriteId}",
        "definition": {
          "entityName": "Favorite",
          "schema": {
            "$ref": "#/backend/entities/Favorite"
          },
          "description": "Stores a user's favorite items (housing, tutoring, event). Only the user can manage their own favorites.",
          "params": [
            {
              "name": "favoriteId",
              "description": "The unique identifier for the favorite item."
            }
          ]
        }
      },
      {
        "path": "/oauthProviders/{oAuthProviderId}",
        "definition": {
          "entityName": "OAuthProvider",
          "schema": {
            "$ref": "#/backend/entities/OAuthProvider"
          },
          "description": "Stores OAuth provider details for user authentication. Only the user can manage their own OAuth providers.",
          "params": [
            {
              "name": "oAuthProviderId",
              "description": "The unique identifier for the OAuth provider."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure security, scalability, and ease of debugging, adhering to the principles of Authorization Independence and Structural Segregation.\n\n*   **Authorization Independence:** Authorization data is denormalized to avoid `get()` calls in security rules. For example, `Housing`, `Carpooling`, `Tutoring`, and `Event` documents are stored under the respective user's document (`/users/{userId}`).\n*   **Structural Segregation:** Each collection contains documents with similar access requirements. User profiles are stored under `/users/{userId}`, ensuring that only the user can access their data. Public events are stored in the `/events` collection.\n*   **QAPs (Rules Are Not Filters):** The structure supports secure `list` operations by segregating data based on ownership and access control requirements. Path-based ownership (e.g., `/users/{userId}/housings/{housingId}`) allows for efficient and secure listing of user-owned resources.\n\nThis design facilitates simple, robust, and easily debuggable security rules, avoiding complex hierarchical dependencies and ensuring data integrity."
  }
}